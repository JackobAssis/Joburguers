<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Painel Admin - Joburguers</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üçî</text></svg>">
  <link rel="stylesheet" href="css/admin.css">
</head>
<body class="admin-body">
  <header class="admin-header">
    <div class="admin-header__container">
      <div class="admin-header__left">
        <button id="hamburgerBtn" class="hamburger-btn" aria-label="Abrir menu">
          <span class="hamburger-icon" aria-hidden="true">
            <span></span><span></span><span></span>
          </span>
          <span style="font-size:0.95rem; color:#fff;">Menu</span>
        </button>
        <h1 class="admin-header__title">üçî Joburguers - Admin</h1>
      </div>

      <div class="admin-header__actions">
        <span id="adminUsername" class="admin-header__user">Admin</span>
        <button id="adminLogoutBtn" class="btn btn--danger">Sair</button>
      </div>
    </div>
  </header>

  <!-- overlay for mobile sidebar -->
  <div id="sidebarOverlay" class="sidebar-overlay" style="display:none;"></div>

  <!-- Sidebar (desktop visible, mobile will be toggled) -->
  <aside id="adminSidebar" class="admin-sidebar" role="navigation" aria-label="Navega√ß√£o admin">
    <nav class="admin-nav">
      <button class="admin-nav__item admin-nav__item--active" data-section="dashboard">üìä Dashboard</button>
      <button class="admin-nav__item" data-section="produtos">üçî Produtos</button>
      <button class="admin-nav__item" data-section="clientes">üë• Clientes</button>
      <button class="admin-nav__item" data-section="promocoes">üéâ Promo√ß√µes</button>
      <button class="admin-nav__item" data-section="resgates">üéÅ Resgates</button>
      <button class="admin-nav__item" data-section="configuracoes">‚öôÔ∏è Configura√ß√µes</button>
    </nav>
  </aside>

  <main class="admin-content">
    <!-- Dashboard -->
    <section id="dashboard" class="admin-section admin-section--active">
      <h2>Dashboard</h2>
      <div class="dashboard-stats">
        <div class="stat-box"><div><p class="stat-box__label">Produtos</p><p id="totalProducts" class="stat-box__value">0</p></div></div>
        <div class="stat-box"><div><p class="stat-box__label">Clientes</p><p id="totalClientes" class="stat-box__value">0</p></div></div>
        <div class="stat-box"><div><p class="stat-box__label">Pontos</p><p id="totalPoints" class="stat-box__value">0</p></div></div>
        <div class="stat-box"><div><p class="stat-box__label">Transa√ß√µes</p><p id="recentTransactions" class="stat-box__value">0</p></div></div>
      </div>

      <div class="dashboard-recent">
        <h3>Atividades Recentes</h3>
        <div id="recentActivities" class="activities-list"></div>
      </div>
    </section>

    <!-- Produtos -->
    <section id="produtos" class="admin-section">
      <div class="section-header">
        <h2>Gerenciar Produtos</h2>
        <button id="addProductBtn" class="btn btn--primary">+ Novo Produto</button>
      </div>

      <div class="admin-filters">
        <input id="productSearch" type="text" placeholder="Buscar produto...">
        <select id="productCategoryFilter">
          <option value="">Todas as categorias</option>
          <option value="hamburguer">Hamb√∫rguer</option>
          <option value="bebida">Bebida</option>
          <option value="combo">Combo</option>
          <option value="acompanhamento">Acompanhamento</option>
        </select>
      </div>

      <div id="productsList" class="admin-table-container">
        <table class="admin-table">
          <thead><tr><th>Imagem</th><th>Nome</th><th>Categoria</th><th>Pre√ßo</th><th>Status</th><th>A√ß√µes</th></tr></thead>
          <tbody id="productsTableBody"></tbody>
        </table>
      </div>
      <div id="emptyProducts" style="display:none; padding:1rem;">Nenhum produto cadastrado</div>
    </section>

    <!-- Clientes -->
    <section id="clientes" class="admin-section">
      <div class="section-header">
        <h2>Gerenciar Clientes</h2>
        <button id="addClientBtn" class="btn btn--primary">+ Novo Cliente</button>
      </div>

      <div class="admin-filters">
        <input id="clientSearch" type="text" placeholder="Buscar cliente...">
      </div>

      <div id="clientsList" class="admin-table-container">
        <table class="admin-table">
          <thead><tr><th>Nome</th><th>Telefone</th><th>Pontos</th><th>N√≠vel</th><th>Cadastro</th><th>A√ß√µes</th></tr></thead>
          <tbody id="clientsTableBody"></tbody>
        </table>
      </div>
      <div id="emptyClients" style="display:none; padding:1rem;">Nenhum cliente cadastrado</div>
    </section>

    <!-- Promo√ß√µes -->
    <section id="promocoes" class="admin-section">
      <div class="section-header">
        <h2>Gerenciar Promo√ß√µes</h2>
        <button id="addPromotionBtn" class="btn btn--primary">+ Nova Promo√ß√£o</button>
      </div>

      <div id="promotionsList" class="admin-table-container">
        <table class="admin-table">
          <thead><tr><th>Imagem</th><th>Nome</th><th>Pre√ßo</th><th>Descri√ß√£o</th><th>Status</th><th>A√ß√µes</th></tr></thead>
          <tbody id="promotionsTableBody"></tbody>
        </table>
      </div>
    </section>

    <!-- Resgates -->
    <section id="resgates" class="admin-section">
      <div class="section-header">
        <h2>Gerenciar Resgates</h2>
        <button id="addRedeemBtn" class="btn btn--primary">+ Novo Resgate</button>
      </div>

      <div id="redeemList" class="admin-table-container">
        <table class="admin-table">
          <thead><tr><th>Produto</th><th>Pontos</th><th>Status</th><th>A√ß√µes</th></tr></thead>
          <tbody id="redeemsTableBody"></tbody>
        </table>
      </div>
    </section>

    <!-- Configura√ß√µes -->
    <section id="configuracoes" class="admin-section">
      <h2>Configura√ß√µes do Sistema</h2>
      
      <div class="settings-container">
        <!-- Configura√ß√µes de Pontos -->
        <div class="settings-card">
          <div class="settings-card__header">
            <div class="settings-card__icon">‚≠ê</div>
            <div>
              <h3>Sistema de Pontos</h3>
              <p>Configure como os pontos s√£o distribu√≠dos</p>
            </div>
          </div>
          <form id="pointsSettingsForm" class="settings-form">
            <div class="form-row">
              <div class="form-group">
                <label for="pointsPerReal">Pontos por R$</label>
                <input id="pointsPerReal" type="number" step="0.1" min="0.1" placeholder="0.1">
                <small>Quantos pontos o cliente ganha por real gasto</small>
              </div>
              <div class="form-group">
                <label for="bonusRegistration">B√¥nus de Cadastro</label>
                <input id="bonusRegistration" type="number" min="0" placeholder="50">
                <small>Pontos ganhos ao criar uma conta</small>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="referralBonus">B√¥nus de Indica√ß√£o</label>
                <input id="referralBonus" type="number" min="0" placeholder="50">
                <small>Pontos ganhos ao indicar um amigo</small>
              </div>
            </div>
            <div class="form-actions">
              <button type="submit" class="btn btn--primary">
                <span>üíæ</span> Salvar Configura√ß√µes
              </button>
            </div>
          </form>
        </div>

        <!-- Informa√ß√µes da Loja -->
        <div class="settings-card">
          <div class="settings-card__header">
            <div class="settings-card__icon">üè™</div>
            <div>
              <h3>Informa√ß√µes da Loja</h3>
              <p>Dados que aparecem no app e comunica√ß√µes</p>
            </div>
          </div>
          <form id="storeInfoForm" class="settings-form">
            <div class="form-row">
              <div class="form-group">
                <label for="storeName">Nome da Loja</label>
                <input id="storeName" type="text" placeholder="Joburguers">
              </div>
              <div class="form-group">
                <label for="storePhone">Telefone/WhatsApp</label>
                <input id="storePhone" type="tel" placeholder="(81) 98933-4497">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="storeAddress">Endere√ßo Completo</label>
                <input id="storeAddress" type="text" placeholder="Rua Pas√°rgada, Tr√™s Marias - Carpina, PE">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="storeHours">Hor√°rio de Funcionamento</label>
                <input id="storeHours" type="text" placeholder="Seg-Dom: 6:30h √†s 22h">
              </div>
            </div>
            <div class="form-actions">
              <button type="submit" class="btn btn--primary">
                <span>üíæ</span> Salvar Informa√ß√µes
              </button>
            </div>
          </form>
        </div>

        <!-- Gerenciamento de Dados -->
        <div class="settings-card">
          <div class="settings-card__header">
            <div class="settings-card__icon">üóÉÔ∏è</div>
            <div>
              <h3>Gerenciamento de Dados</h3>
              <p>Backup, importa√ß√£o e limpeza do sistema</p>
            </div>
          </div>
          <div class="settings-actions">
            <div class="action-group">
              <h4>Backup e Restore</h4>
              <div class="button-group">
                <button id="exportDataBtn" class="btn btn--secondary">
                  <span>üì•</span> Exportar Dados
                </button>
                <button id="importDataBtn" class="btn btn--secondary">
                  <span>üì§</span> Importar Dados
                </button>
                <input id="importFile" type="file" accept=".json" style="display:none;">
              </div>
              <small>Fa√ßa backup dos dados ou restaure de um arquivo JSON</small>
            </div>
            
            <div class="action-group action-group--danger">
              <h4>Zona de Perigo</h4>
              <button id="resetDataBtn" class="btn btn--danger">
                <span>üóëÔ∏è</span> Limpar Todos os Dados
              </button>
              <small>‚ö†Ô∏è Esta a√ß√£o n√£o pode ser desfeita!</small>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Overlays / Modals -->

  <!-- Product view modal (opens when clicking row) -->
  <div id="productViewModal" class="modal" aria-hidden="true">
    <div class="modal__content">
      <h2 id="productViewTitle">Produto</h2>
      <div class="modal-product-image-container" id="productViewImageContainer">
        <img id="productViewImage" src="" alt="Imagem do produto">
      </div>
      <p id="productViewCategory" style="color:#9aa4b6"></p>
      <p id="productViewPrice" style="font-weight:700; color:var(--accent)"></p>
      <p id="productViewDescription"></p>
      <p id="productViewIngredients" style="color:#9aa4b6"></p>
      <p id="productViewAvailable" style="margin-top:.5rem;"></p>

      <div style="display:flex; gap:.5rem; margin-top:1rem;">
        <button id="productViewEditBtn" class="table-btn table-btn--edit">Editar</button>
        <button id="productViewDeleteBtn" class="table-btn table-btn--delete">Deletar</button>
        <button id="productViewClose" class="btn">Fechar</button>
      </div>
    </div>
  </div>

  <!-- Generic form modals (product, client, promotion, redeem) -->
  <!-- Product Form Modal -->
  <div id="productModal" class="modal"><div class="modal__content">
    <h2 id="productModalTitle">Novo Produto</h2>
    <form id="productForm">
      <div style="display:grid; gap:12px;">
        <label>Nome <input id="productName" required></label>
        <label>Categoria
          <select id="productCategory" required>
            <option value="">Selecione</option>
            <option value="hamburguer">Hamb√∫rguer</option>
            <option value="bebida">Bebida</option>
            <option value="combo">Combo</option>
            <option value="acompanhamento">Acompanhamento</option>
          </select>
        </label>
        <label>Pre√ßo <input id="productPrice" type="number" step="0.01" required></label>
        <label>Imagem (URL) ‚Äî opcional <input id="productImage" type="url"></label>
        <label>Upload imagem opcional <input id="productImageFile" type="file" accept="image/*"></label>
        <label>Descri√ß√£o <textarea id="productDescription" rows="3" required></textarea></label>
        <label>Ingredientes (v√≠rgula) <input id="productIngredients" type="text"></label>
        <label><input id="productAvailable" type="checkbox" checked> Dispon√≠vel</label>
      </div>
      <div style="display:flex; gap:.5rem; margin-top:12px;">
        <button type="submit" class="btn btn--primary">Salvar</button>
        <button type="button" id="closeProductModal" class="btn">Cancelar</button>
      </div>
    </form>
  </div></div>

  <!-- Client Form Modal -->
  <div id="clientModal" class="modal"><div class="modal__content">
    <h2 id="clientModalTitle">Novo Cliente</h2>
    <form id="clientForm">
      <label>Nome <input id="clientName" required></label>
      <label>Telefone <input id="clientPhone" required></label>
      <label>Email <input id="clientEmail" type="email"></label>
      <label>Senha <input id="clientPassword" type="text"></label>
      <label>Pontos iniciais <input id="clientPoints" type="number" value="0"></label>
      <label><input id="clientActive" type="checkbox" checked> Ativo</label>
      <div style="display:flex; gap:.5rem; margin-top:12px;">
        <button type="submit" class="btn btn--primary">Salvar</button>
        <button type="button" id="closeClientModal" class="btn">Cancelar</button>
      </div>
    </form>
  </div></div>

  <!-- Promotion Modal -->
  <div id="promotionModal" class="modal"><div class="modal__content">
    <h2 id="promotionModalTitle">Nova Promo√ß√£o</h2>
    <form id="promotionForm">
      <label>Nome <input id="promotionName" required></label>
      <label>Valor <input id="promotionValue" required></label>
      <label>Descri√ß√£o <textarea id="promotionDescription" required></textarea></label>
      <label>Foto (upload) <input id="promotionPhoto" type="file" accept="image/*"></label>
      <label>Instagram <input id="promotionInstagramLink" type="url"></label>
      <label><input id="promotionActive" type="checkbox" checked> Ativa</label>
      <div style="display:flex; gap:.5rem; margin-top:12px;">
        <button type="submit" class="btn btn--primary">Salvar</button>
        <button type="button" id="closePromotionModal" class="btn">Cancelar</button>
      </div>
    </form>
  </div></div>

  <!-- Redeem Modal -->
  <div id="redeemModal" class="modal"><div class="modal__content">
    <h2 id="redeemModalTitle">Novo Resgate</h2>
    <form id="redeemForm">
      <label>Produto <select id="redeemProduct"></select></label>
      <label>Pontos necess√°rios <input id="redeemPointsRequired" type="number" min="1"></label>
      <label><input id="redeemActive" type="checkbox" checked> Ativo</label>
      <div style="display:flex; gap:.5rem; margin-top:12px;">
        <button type="submit" class="btn btn--primary">Salvar</button>
        <button type="button" id="closeRedeemModal" class="btn">Cancelar</button>
      </div>
    </form>
  </div></div>

  <script type="module" src="js/admin.js"></script>
  <script type="module" src="js/image-migration.js"></script>
</body>
</html>
